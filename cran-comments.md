Minor refactoring of private functions.

## Test environments

* local Windows 10 (x64) release, R 3.6.0
* OS X install (on travis-ci) R-release
* Ubuntu 12.04 (on travis-ci) R-release
* Windows Server 2012 R2 x64 install (on appveyor), R 3.6.1
* Rhub:
  * Fedora Linux, R-devel, clang, gfortran
  * Ubuntu Linux 16.04 LTS, R-release, GCC
  * Windows Server 2008 R2 SP1, R-devel, 32/64 bit
* win-builder (devel, oldrelease and release)

## R CMD check results

### Generally no errors, no warnings, no notes

```
0 ERRORs | 0 WARNINGs | 0 NOTES.
```

## Downstream dependencies

No ERRORs or WARNINGs found 
